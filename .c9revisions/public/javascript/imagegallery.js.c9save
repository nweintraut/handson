{"ts":1372975319000,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"/*global Backbone, jQuery, _ */\n\nvar ImageGallery = ImageGallery || {};\n\nImageGallery.Image = Backbone.Model.extend({\n    \n});\n\nImageGallery.vent = _.extend({}, Backbone.Events);\nImageGallery.ImageCollection= Backbone.Collection.extend({\n    model: ImageGallery.Image\n});\n\nImageGallery.AddImageView = Backbone.View.extend ({\n    id: \"add-image-form\",\n    template: \"#add-image-template\",\n    \n    events: {\n        \"change #name\": \"nameChanged\",\n        \"change #description\": \"descriptionChanged\",\n        \"change #url\": \"urlChanged\",\n        \"click #save\": \"saveImage\"\n    },\n    nameChanged: function(e){\n        var value = $(e.currentTarget).val();\n        this.model.set({name: value});\n    },\n    descriptionChanged: function(e){\n        var value = $(e.currentTarget).val();\n        this.model.set({description: value});\n    },\n    urlChanged: function(e) {\n        var value = $(e.currentTarget).val();\n        this.model.set({url: value});\n        this.$(\"#preview\").attr(\"src\", value);\n    },\n    saveImage: function(e){\n        e.preventDefault();\n //       var name = this.model.get(\"name\");\n //       var desc = this.model.get(\"description\");\n //       var url  = this.model.get(\"url\");\n        this.collection.add(this.model);           \n    },\n    render: function(){\n        var html = $(this.template).tmpl();\n        $(this.el).html(html);\n    }\n});\n\nImageGallery.ImageListView = Backbone.View.extend({\n    tagName: \"ul\",\n//    template: \"#image-preview-template\",\n    template: '<li><a href=\"#\" data-id=\"${id}\"><img src=\"${url}\" width=\"150\" height=\"100\" alt=\"${description}\"><span class=\"image-label\">${name}</span></a></li>',\n/*\n    events: {\n        \"click a\": \"imageClicked\"\n    },\n    imageClicked: function(e) {\n        e.preventDefault();\n        var id= $(e.currentTarget).data(\"id\");\n        var image = this.collection.get(id);\n        // tell the app the image was clicked\n        ImageGallery.vent.trigger(\"image:selected\", image);\n        \n    },\n    \n*/\n    initialize: function(){\n        _.bindAll(this, \"renderImage\");\n//        this.template = $(this.template);\n        this.collection.bind(\"add\", this.renderImage, this);\n    },\n    \n    renderImage: function(image){\n        var imagePreview = new ImageGallery.ImagePreview({model: image});\n        imagePreview.render();\n        $(this.el).prepend(imagePreview.el);\n        /*\n        var html = this.template.tmpl(image.toJSON());\n        // prepend so that newest image is put at top\n        $(this.el).prepend(html);\n        */\n    },\n    render: function() {\n        this.collection.each(this.renderImage);\n    }\n});\nImageGallery.ImageView = Backbone.View.extend({\n    \n    template: \"#image-view-template\",\n    className: \"image-view\",\n    \n    render: function(){\n        var html = $(this.template).tmpl(this.model.toJSON());\n        $(this.el).html(html);\n    }\n    \n});\n\nImageGallery.Router = Backbone.Router.extend({\n    routes: {\n        \"\": \"newImage\",\n        \"images/new\": \"newImage\",\n        \"images/:id\": \"showImage\"\n    },\n    initialize: function(options) {\n        this.collection = options.collection;\n    },\n    showImage: function(id) {\n        var image = this.collection.get(id);\n        ImageGallery.showImage(image);\n    },\n    newImage: function(){\n        ImageGallery.addImage(this.collection);\n    }\n});\n\nImageGallery.ImagePreview = Backbone.View.extend({\n//    template: \"#image-preview-template\",\n    template: '<li><a href=\"#\" data-id=\"${id}\"><img src=\"${url}\" width=\"150\" height=\"100\" alt=\"${description}\"><span class=\"image-label\">${name}</span></a></li>',\n    \n    events: {\n        \"click a\": \"imageClicked\"\n    }, \n    imageClicked: function(e) {\n        e.preventDefault();\n        ImageGallery.vent.trigger(\"image:selected\", this.model);    \n    },\n    initialize: function() {\n        this.template = $(this.template);\n    },\n    render: function(){\n        var html = this.template.tmpl(this.model.toJSON());\n        $(this.el).html(html);  \n    }\n});\n\n\nImageGallery.addImage = function(images) {\n    var image = new ImageGallery.Image();\n    var addImageView = new ImageGallery.AddImageView({model: image, collection: images});\n    addImageView.render();\n    $(\"#main\").html(addImageView.el);\n};\n\nImageGallery.showImage = function(image) {\n    var imageView = new ImageGallery.ImageView({\n        model:image\n    });\n    imageView.render();\n    $(\"#main\").html(imageView.el);\n};\n\n$(function() {\n    \n    var imageData = [\n        {\n            id: 1,\n            url: \"/images/island.jpeg\",\n            name: \"Some island\",\n        },\n        {\n            id: 2,\n            url: \"/images/mountain.jpeg\",\n            name: \"A mountain\",\n            description: \"A mountin with a grassy hill and tree in front of it.\"\n        },\n        {\n            id: 3,\n            url: \"/images/tools.jpeg\",\n            name: \"A rusty wrench\",\n            description: \"A close up view of a rusty wrench with great color and texture.\"\n        }, \n        {\n            id: 4,\n            url: \"images/tree.jpeg\",\n            name: \"A purple flower\",\n            description: \"A purple flower with a water drop hanging off another plant.\"\n        }\n    ];\n    \n    var images = new ImageGallery.ImageCollection(imageData);    \n    // var image = new ImageGallery.Image();\n\n    ImageGallery.addImage(images);\n\n    images.bind(\"add\", function(){ImageGallery.addImage(images)}); // important bind technique\n    \n    ImageGallery.vent.bind(\"image:selected\", function(image) {\n        ImageGallery.showImage(image);\n        router.navigate(\"images/\" + image.id);\n    });\n    \n    var imageListView = new ImageGallery.ImageListView({collection:images}); \n    imageListView.render();\n    $(\"#image-list\").html(imageListView.el);\n    var router = new ImageGallery.Router({collection:images});\n    Backbone.history.start();\n\n});"]],"start1":0,"start2":0,"length1":0,"length2":5841}]],"length":5841}
{"contributors":[],"silentsave":false,"ts":1372975494824,"patch":[[{"diffs":[[0,"eventDefault();\n"],[1,"        this.model.select();\n//"],[0,"        ImageGal"]],"start1":3687,"start2":3687,"length1":32,"length2":63}]],"length":5872,"saved":false}
{"ts":1372975602271,"patch":[[{"diffs":[[0,"xtend({\n    "],[1,"select: function() {\n        this.set({selected: true});\n    }"],[0,"\n});\n\nImageG"]],"start1":110,"start2":110,"length1":24,"length2":86}]],"length":5934,"saved":false}
{"ts":1372975636801,"patch":[[{"diffs":[[0,"ed: true});\n"],[1,"        ImageGallery.vent.trigger(\"image:selected\", this);\n"],[0,"    }\n});\n\nI"]],"start1":167,"start2":167,"length1":24,"length2":83}]],"length":5993,"saved":false}
{"ts":1372975699887,"patch":[[{"diffs":[[0,".template);\n"],[1,"        this.model.bind(\"change:selected\", imageSelected, this);\n"],[0,"    },\n    r"]],"start1":3990,"start2":3990,"length1":24,"length2":89}]],"length":6058,"saved":false}
{"ts":1372975723508,"patch":[[{"diffs":[[0,":selected\", "],[1,"\""],[0,"imageSelecte"]],"start1":4033,"start2":4033,"length1":24,"length2":25},{"diffs":[[0,"Selected"],[1,"\""],[0,", this);"]],"start1":4051,"start2":4051,"length1":16,"length2":17},{"diffs":[[0,", this);\n    },\n"],[1,"    imageSelected: function(){\n        \n    },\n"],[0,"    render: func"]],"start1":4060,"start2":4060,"length1":32,"length2":79}]],"length":6107,"saved":false}
{"ts":1372975785445,"patch":[[{"diffs":[[0,"ected\", "],[-1,"\""],[1,"this."],[0,"imageSel"]],"start1":4037,"start2":4037,"length1":17,"length2":21},{"diffs":[[0,"mageSelected"],[-1,"\""],[0,", this);\n   "]],"start1":4051,"start2":4051,"length1":25,"length2":24},{"diffs":[[0,"tion(){\n        "],[1,"this.$(\"img\").toggleCLass(\"selected\");"],[0,"\n    },\n    rend"]],"start1":4102,"start2":4102,"length1":32,"length2":70}]],"length":6148,"saved":false}
{"ts":1372975835614,"patch":[[{"diffs":[[0,".toggleC"],[-1,"L"],[1,"l"],[0,"ass(\"sel"]],"start1":4131,"start2":4131,"length1":17,"length2":17}]],"length":6148,"saved":false}
{"ts":1372975925464,"patch":[[{"diffs":[[0,"ed: true});\n"],[1,"        this.collection.select(this);\n"],[0,"        Imag"]],"start1":167,"start2":167,"length1":24,"length2":62}]],"length":6186,"saved":false}
{"ts":1372975954439,"patch":[[{"diffs":[[0,"y.Image\n"],[1,"    select: function(model) {\n        this.set({selected: model});\n    }\n"],[0,"});\n\nIma"]],"start1":419,"start2":419,"length1":16,"length2":89}]],"length":6259,"saved":false}
{"ts":1372975970896,"patch":[[{"diffs":[[0,"allery.Image"],[1,","],[0,"\n    select:"]],"start1":414,"start2":414,"length1":24,"length2":25}]],"length":6260,"saved":false}
{"ts":1372976023916,"patch":[[{"diffs":[[0,"unction("],[-1,"model"],[1,"image"],[0,") {\n    "]],"start1":441,"start2":441,"length1":21,"length2":21},{"diffs":[[0,"his."],[-1,"set({"],[0,"selected"],[-1,": model})"],[1," =image"],[0,";\n  "]],"start1":467,"start2":467,"length1":30,"length2":23}]],"length":6253,"saved":false}
{"ts":1372976030095,"patch":[[{"diffs":[[0,"selected"],[1,"Image"],[0," ="],[1," "],[0,"image;\n "]],"start1":471,"start2":471,"length1":18,"length2":24}]],"length":6259,"saved":false}
{"ts":1372976091577,"patch":[[{"diffs":[[0,"ed\", this);\n"],[1,"    },\n    deselect: function() {\n        this.set({selected: false});\n"],[0,"    }\n});\n\nI"]],"start1":264,"start2":264,"length1":24,"length2":95},{"diffs":[[0,"nction(image) {\n"],[1,"        if (this.selectedImage) {\n            this.selectedImage.deselect();\n        }\n"],[0,"        this.sel"]],"start1":513,"start2":513,"length1":32,"length2":119}]],"length":6417,"saved":false}
{"ts":1372976130716,"patch":[[{"diffs":[[0,"his."],[1,"un"],[0,"set("],[-1,"{"],[1,"\""],[0,"selected"],[-1,": false}"],[1,"\""],[0,");\n "]],"start1":319,"start2":319,"length1":29,"length2":24}]],"length":6412,"saved":false}
{"ts":1372976244990,"patch":[[{"diffs":[[0,"t: function() {\n"],[1,"        if(this.get(\"selected\")) return;\n"],[0,"        this.set"]],"start1":127,"start2":127,"length1":32,"length2":73}]],"length":6453,"saved":false}
{"ts":1372976310145,"patch":[[{"diffs":[[0,"ection.get(id);\n"],[1,"        image.select();\n"],[0,"        ImageGal"]],"start1":3604,"start2":3604,"length1":32,"length2":56}]],"length":6477,"saved":false}
{"ts":1372976446086,"patch":[[{"diffs":[[0,"n(images) {\n"],[1,"    images.deselect();\n"],[0,"    var imag"]],"start1":4653,"start2":4653,"length1":24,"length2":47}]],"length":6500,"saved":false}
{"ts":1372976506140,"patch":[[{"diffs":[[0,"unction(image) {"],[1,"\n\n        this.selectedImage = image;\n    },\n    deselect: function() {"],[0,"\n        if (thi"]],"start1":548,"start2":548,"length1":32,"length2":103},{"diffs":[[0,"   }"],[-1,"\n"],[0,"        "],[-1,"this.selectedImage = image;"],[0,"\n   "]],"start1":718,"start2":718,"length1":44,"length2":16}]],"length":6543,"saved":false}
{"ts":1372976524136,"patch":[[{"diffs":[[0,"mage) {\n"],[1,"        this.deselect();"],[0,"\n       "]],"start1":557,"start2":557,"length1":16,"length2":40}]],"length":6567,"saved":false}
{"ts":1372976624122,"patch":[[{"diffs":[[0,"age.deselect();\n"],[1,"            delete this.selectedImage;\n"],[0,"        }       "]],"start1":721,"start2":721,"length1":32,"length2":71}]],"length":6606,"saved":false}
